---
layout: post
title: C++ Attributes
tags: CLang C/C++
---

# CLang Attributes
Full list here: https://clang.llvm.org/docs/AttributeReference.html


## Function multiversioning
Use __attribute__((target (NAME))) to specify the target architecture.
The default function (the first function in the example below) must be specified too. 
~~~ C++
__attribute__ ((target ("default")))
int foo ()
{
	// The default version of foo.
	// Assembler name: _Z3foov
	return 0;
}

__attribute__ ((target ("sse3")))
int foo ()
{
	// foo version for SSE3
	// Assembler name: _Z3foov.sse3
	return 1;
}

__attribute__ ((target ("arch=atom")))
int foo ()
{
	// foo version for the Intel ATOM processor
	// Have distinctive assembler name as other foo()s
	return 2;
}
~~~
Reference: https://gcc.gnu.org/wiki/FunctionMultiVersioning


## Optimization options
__attribute__((optimize("<option>"))) enables setting function-specific optimization option.

According to the clang docs, "Og" is the standard optimization level while debugging (fast compilation & good debugging experience).
Using this option, the order of computation is not changed by the compiler.

~~~ C++
void* foo() __attribute__ ((optimize("Og")));
~~~
Reference: https://gcc.gnu.org/onlinedocs/gcc/Optimize-Options.html


## inline __attribute__((always_inline))
This is a gcc attribute that (A) ignores the 'do not optimize' option while compiling,
(B) ignores the inlining limits, and (C) does not produce an external definition with the external linkage.

~~~ C++
static inline __attribute__((always inline)) int inc (int *a)
{
	return (*a)++;
}
~~~

Reference: https://stackoverflow.com/questions/22767523/what-inline-attribute-always-inline-means-in-the-function


## __attribute__((unused))
This attribute comes after the declaration of a variable or a function which is expected to be possibly unused.
If marked with this attribute, the compiler does not produce a warning. 

~~~ C++
int aUnused __attribute__((unused));
int Function_Attributes_unused_0(int b) __attribute__((unused));
~~~


